<script type="text/javascript">
	console.log("this partical is called")
	$(document).ready(function () {
	    // will call refreshPartial every 3 seconds
	    setInterval(refreshPartial, 3000)

	});

	// calls action refreshing the partial
	function refreshPartial() {
		$.getJSON( "simulation", function( data ) {
	  		console.log(data);
	  		  $.each(data,function(key,value){
	  		  	console.log(value);
	  		  	console.log(value.time);
				L.marker([ value.latitude , value.longitude], {icon: smile, riseOnHover:true}).addTo(map).bindPopup("<b>"+value.drifter_name+", "+value.time+". My current speed is "+value.gps_speed+"</b>").openPopup();
				var popup = L.popup();
				function onMapClick(e) {
					popup
						.setLatLng(e.latlng)
						.setContent("You clicked the map at " + e.latlng.toString())
						.openOn(map);
				}
				map.on('click', onMapClick);
	  		  });
		});
	}

</script>
