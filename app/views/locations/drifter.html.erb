<% if first_long %>
<div id="map">	
	<script>
			var map = new L.Map('map', {center: new L.LatLng(<%= first_lat%>-0.36093, <%= first_long%>+.26494), zoom: 16});
			//0.36093, -122.25803
      		var googleLayer = new L.Google('SATELLITE');
      		map.addLayer(googleLayer);
			 var adjust = L.AwesomeMarkers.icon({
			    icon: 'fa-adjust',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var asterisk = L.AwesomeMarkers.icon({
			    icon: 'fa-asterisk',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var down = L.AwesomeMarkers.icon({
			    icon: 'fa-hand-o-down',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var archive = L.AwesomeMarkers.icon({
			    icon: 'fa-archive',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var circle = L.AwesomeMarkers.icon({
			    icon: 'fa-circle',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var cloud = L.AwesomeMarkers.icon({
			    icon: 'fa-cloud',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var certificate = L.AwesomeMarkers.icon({
			    icon: 'fa-certificate',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var fighter_jet = L.AwesomeMarkers.icon({
			    icon: 'fa-fighter-jet',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var coffee = L.AwesomeMarkers.icon({
			    icon: 'fa-coffee',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var cog = L.AwesomeMarkers.icon({
			    icon: 'fa-cog',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var bug = L.AwesomeMarkers.icon({
			    icon: 'fa-bug',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var beer = L.AwesomeMarkers.icon({
			    icon: 'fa-beer',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var arrow = L.AwesomeMarkers.icon({
			    icon: 'fa-arrow-circle-o-right',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var dot = L.AwesomeMarkers.icon({
			    icon: 'fa-dot-circle-o',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var plus = L.AwesomeMarkers.icon({
			    icon: 'fa-plus-circle',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var rocket = L.AwesomeMarkers.icon({
			    icon: 'fa-rocket',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var smile = L.AwesomeMarkers.icon({
			    icon: 'fa-smile-o',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var star = L.AwesomeMarkers.icon({
			    icon: 'fa-star-o',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var shopping = L.AwesomeMarkers.icon({
			    icon: 'fa-shopping-cart',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var trophy = L.AwesomeMarkers.icon({
			    icon: 'fa-trophy',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			 var tachometer = L.AwesomeMarkers.icon({
			    icon: 'fa-tachometer',
			    prefix: 'fa',
			    markerColor:'orange'
			  });
			<% if @specific %>
				<% valid = @location.valid_input.to_s %>
				<% name = @location.drifter_name.to_s %>
				<% time = @location.time.to_s %>
				<% speed = @location.gps_speed %>
				  L.marker([ <%= @location.latitude%> , <%= @location.longitude%>], {icon: smile, riseOnHover:true}).addTo(map).bindPopup("<b>"+"<%= name %>"+", "+"<%= time %>"+". My current speed is "+"<%= speed %>"+"</b>").openPopup();
			<% else %>
				<% if @location %>
					<% @location.each do |location| %>
						<% valid = location.valid_input.to_s %>
						<% name = location.drifter_name.to_s %>
						<% time = location.time.to_s %>
						<% speed = location.gps_speed %>
						  L.marker([ <%= location.latitude%> , <%= location.longitude%>], {icon: smile, riseOnHover:true}).addTo(map).bindPopup("<b>"+"<%= name %>"+", "+"<%= time %>"+". My current speed is "+"<%= speed %>"+"</b>").openPopup();
					<% end%>
				<% else %>
					$(#map).text(Something went wrong. Please contact roberterickhernandez@gmail.com for more information);
				<% end %>
			<% end %>
			
			var popup = L.popup();
			function onMapClick(e) {
				popup
					.setLatLng(e.latlng)
					.setContent("You clicked the map at " + e.latlng.toString())
					.openOn(map);
			}
			map.on('click', onMapClick);
	</script>
</div>
<% else %>
Please wait for first data point to come in...
<% end %>

    